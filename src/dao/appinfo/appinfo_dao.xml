<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dao.appinfo.appinfo_dao">

	<select id="AppinfocountAll" resultType="Integer">
		select COUNT(*) from
		app_info
	</select>
	<resultMap type="app_info" id="app_info_map">
		<id property="id" column="id" />
		<result property="flatformName" column="pctyp1" />
		<result property="categoryLevel1Name" column="type1" />
		<result property="categoryLevel2Name" column="type2" />
		<result property="categoryLevel3Name" column="type3" />
		<result property="statusName" column="apptype" />
		<result property="versionNo" column="vtype" />
	</resultMap>


	<select id="selectToday" resultMap="app_info_map">
		select app.*,d.valueName as pctyp1 ,c1.categoryName as
		type1,c2.categoryName
		as type2 ,c3.categoryName as type3,d1.valueName
		as
		apptype,v.versionNo
		as vtype
		from app_info as app ,data_dictionary as
		d
		,app_category as c1
		,app_category as c2 ,app_category as c3 ,
		data_dictionary d1 ,
		app_version as v
		where d.valueId = app.flatformId
		and d.typeCode =
		'APP_FLATFORM' and c1.id
		= app.categoryLevel1 and c2.id
		=
		app.categoryLevel2 and c3.id =
		app.categoryLevel3
		and d1.typeCode =
		'APP_STATUS' and d1.valueId = app.`status` and
		app.versionId= v.id

		<trim suffix="limit  #{page.word},#{page.pageSize} ">

			<if test="appinfoselect!=null">
				<if test="appinfoselect.AppName!=null and appinfoselect.AppName!=''">

					and softwareName like
					CONCAT("%",#{appinfoselect.AppName},"%")
				</if>
				<if
					test="appinfoselect.flatformId!=null and appinfoselect.flatformId!=''">
					and flatformId = #{appinfoselect.Type}
				</if>
				<if test="appinfoselect.PcNameID!=null and appinfoselect.PcNameID!=''">
					and devId = #{appinfoselect.PcNameID}
				</if>

				<if test="appinfoselect.classify1!=null and appinfoselect.classify1!=''">
					and categoryLevel1 = #{appinfoselect.classify1}
				</if>

				<if test="appinfoselect.classify2!=null and appinfoselect.classify2!=''">
					and categoryLevel2 = #{appinfoselect.classify2}
				</if>

				<if test="appinfoselect.classify3!=null and appinfoselect.classify3!=''">
					and categoryLevel3 = #{appinfoselect.classify3}
				</if>
			</if>
		</trim>



	</select>
</mapper>